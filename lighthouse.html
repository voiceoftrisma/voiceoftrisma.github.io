<script>
  const audioStream = "https://i.klikhost.com:8502/"
  function shoutcastCallback(data) {
    console.log("Status Check:", data.streamstatus === 1 ? "Online" : "Offline");
    
    if (data.streamstatus === 1) {
      console.log("Stream aktif! Mengalihkan...");
      clearInterval(checkInterval);
      // window.location.href = `${audioStream}stream`;
      window.location.href = `/play`;
    }
  }

  function getStats() {
    const oldScript = document.getElementById('shoutcast-script');
    if (oldScript) oldScript.remove();

    const script = document.createElement('script');
    script.id = 'shoutcast-script';
    script.src = `${audioStream}stats?json=1&callback=shoutcastCallback&t=` + new Date().getTime();
    
    script.onerror = function() {
      console.error("Gagal memuat status.");
    };
    document.head.appendChild(script);
  }
  const checkInterval = setInterval(getStats, 1000);
  getStats();
</script>